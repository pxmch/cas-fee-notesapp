{"version":3,"sources":["Note.js","NoteList.js","helper.js","main.js","event_handler.js"],"names":["Note","title","description","priority","duedate","isDone","finishdate","_id","self","this","isNaN","createdate","Date","now","NoteList","hasStorage","localStorage","setItem","removeItem","exception","loadItems","$","get","SERVER","data","items","JSON","parse","refreshList","fail","window","console","log","storeItems","STORAGE_KEY","stringify","alert","HTML_SELECTOR","trigger","showFinished","DATA_STATE_SYNCED","DATA_STATE_NEEDS_RESYNC","syncState","resyncQueue","init","getItem","index","addItem","item","ajax","url","type","contentType","crossDomain","success","status","jqXHR","d","push","replaceItem","splice","deleteItem","id","toggleShowFinished","sortItems","field","order","sort","a","b","parseInt","getFormattedDate","date","isDisplayed","month","getMonth","day","getDate","moment","locale","calendar","lastDay","sameDay","nextDay","lastWeek","nextWeek","sameElse","getFullYear","getToday","getTomorrow","setCookie","name","value","expiry","document","cookie","encodeURIComponent","getCookie","cookies","length","val","match","decodeURIComponent","toggleEditMask","state","addClass","hide","removeClass","reset","show","updateSortIndicators","$current","parent","find","initTheme","THEME_COOKIE_NAME","THEME_CLASS_NAME","initDescriptionMoreLinks","each","height","append","on","e","options","source","html","template","Handlebars","compile","displayList","text","toggleClass","cval","hasClass","TheNoteList","icon","prop","finishdate_tmp","$more","clearTimeout","resizeTimer","setTimeout","confirm","attr","registerHelper"],"mappings":"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","file":"main.js","sourcesContent":["'use strict';\n\n/**\n * Class Note\n */\n\nfunction Note(title, description, priority, duedate, isDone, finishdate, _id) {\n  var self = this;\n  self._id = (typeof _id != 'undefined') ? _id : null;\n  self.title = title;\n  self.description = description;\n  self.priority = (typeof priority != 'undefined' && !isNaN(priority)) ? priority : 0;;\n  self.duedate = (typeof duedate != 'undefined' && !isNaN(duedate)) ? duedate : 0;\n  self.isDone = (typeof isDone != 'undefined') ? isDone : false;\n  self.createdate = Date.now();\n  self.finishdate = finishdate;\n}\n","'use strict';\n\n/**\n * Class NoteList\n */\n\nfunction NoteList() {\n\n  const HTML_SELECTOR = '.note_list';\n  const STORAGE_KEY = 'note-items';\n  const SERVER = 'http://127.0.0.1:3001';\n  const DATA_STATE_SYNCED = 1;\n  const DATA_STATE_NEEDS_RESYNC = 2;\n  const DATA_STATE_LOCAL_STORAGE = 3;\n  const DATA_STATE_MEMORY_ONLY = 4;\n\n  var self = this;\n  self.items = [];\n  self.showFinished = false;\n  self.syncState = DATA_STATE_SYNCED;\n  self.resyncQueue = [];\n\n  self.init = function(){\n    loadItems();\n  };\n\n  self.getItem = function(index){\n    return self.items[index];\n  };\n\n  self.addItem = function(item) {\n    delete item['_id'];\n    // save to server\n    $.ajax({\n      url: SERVER+'/note',\n      type:'POST',\n      data: JSON.stringify(item),\n      contentType: 'application/json; charset=utf-8',\n      crossDomain: true,\n      success: function( data, status, jqXHR){\n        var d=JSON.parse(data);\n        item._id = d._id;\n        // save locally\n        self.items.push(item);\n        storeItems();\n      }\n    }).fail(function(){\n      self.syncState = DATA_STATE_NEEDS_RESYNC;\n      self.resyncQueue.push(item);\n      window.console && console.log('server store failed!');\n      // save locally\n      self.items.push(item);\n      storeItems();\n    });\n\n  };\n\n  self.replaceItem = function(index, item) {\n    // save locally\n    self.items.splice(index, 1, item);\n    // save to server\n    $.ajax({\n      url: SERVER+'/note/'+item._id,\n      type:'PUT',\n      data: JSON.stringify(item),\n      contentType: 'application/json; charset=utf-8',\n      crossDomain: true\n    }).fail(function(){\n      self.syncState = DATA_STATE_NEEDS_RESYNC;\n      self.resyncQueue.push(item);\n      window.console && console.log('server store failed!');\n    });\n    storeItems();\n  };\n\n  self.deleteItem = function(index, id) {\n    self.items.splice(index, 1);\n    // delete from server\n    $.ajax({\n      url: SERVER+'/note/'+id,\n      type:'DELETE',\n      contentType: 'application/json; charset=utf-8',\n      crossDomain: true\n    }).fail(function(){\n      window.console && console.log('server delete failed!');\n    });\n    storeItems();\n  };\n\n  self.toggleShowFinished = function() {\n    self.showFinished = !self.showFinished;\n    refreshList();\n    return self.showFinished\n  }\n\n  self.sortItems = function(field, order) {\n    switch(field) {\n      case 'duedate':\n        self.items.sort(function(a,b) {\n          return (order == 'asc') ? parseInt(a.duedate) - parseInt(b.duedate) : parseInt(b.duedate) - parseInt(a.duedate);\n        });\n        break;\n      case 'priority':\n        self.items.sort(function(a,b) {\n          return (order == 'asc') ? a.priority - b.priority : b.priority - a.priority;\n        });\n        break;\n      case 'createdate':\n        self.items.sort(function(a,b) {\n          return (order == 'asc') ? parseInt(a.createdate) - parseInt(b.createdate) : parseInt(b.createdate) - parseInt(a.createdate);\n        });\n        break;\n    }\n    storeItems();\n  }\n\n  function hasStorage() {\n    try {\n      localStorage.setItem('test-storage', 'test');\n      localStorage.removeItem('test-storage');\n      return true;\n    }\n    catch (exception) {\n      return false;\n    }\n  }\n\n  function loadItems() {\n    $.get( SERVER+'/all', function( data ) {\n      // load from server\n      self.items = JSON.parse(data);\n      refreshList();\n    }).fail(function(){\n      window.console && console.log('loading items failed!');\n    });\n  }\n\n  function storeItems() {\n    if (!hasStorage()){\n      alert('No local storage available.');\n      return;\n    }\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(self.items));\n    refreshList();\n  }\n\n  function refreshList() {\n    $(HTML_SELECTOR).trigger('notelist:refresh', [{showFinished: self.showFinished, items: self.items}]);\n  };\n}\n","'use strict';\n\n/**\n * helper\n */\n\nHandlebars.registerHelper('formattedDate', function (data) {\n\n  //console.log('date in registeredHelper '+ data.toString());\n  if (data === 0) {\n    return '';\n  }\n  var date = new Date(data);\n  return getFormattedDate(date, true);\n});\n\nfunction getFormattedDate(date, isDisplayed) {\n\n  var d = date;\n  var month = (d.getMonth() + 1);\n  var day = d.getDate();\n\n  if (month < 10) {\n    month = '0' + month;\n  }\n  if (day < 10) {\n    day = '0' + day;\n  }\n  moment.locale('en', {\n    calendar : {\n      lastDay : '[Yesterday]',\n      sameDay : '[Today]',\n      nextDay : '[Tomorrow]',\n      lastWeek : '[last] dddd',\n      nextWeek : 'dddd',\n      sameElse : 'DD.MM.YYYY'\n    }\n  });\n\n  if (isDisplayed) {\n    return moment('' + d.getFullYear() + month + day, 'YYYYMMDD').calendar();\n  } else {\n    return d.getFullYear() + '-' + month + '-' + day;\n  }\n\n}\n\nfunction getToday() {\n  return getFormattedDate(new Date(Date.now()), false);\n}\n\nfunction getTomorrow() {\n  return getFormattedDate(new Date(Date.now() + 24 * 60 * 60 * 1000), false);\n}\n\nfunction setCookie(name, value, expiry) {\n  document.cookie = name + '=' + encodeURIComponent(value) +\n    '; max-age=' + 60 * 60 * 24 * expiry +\n    '; path=/';\n}\n\nfunction getCookie(name) {\n  var cookies = document.cookie;\n  if (cookies && cookies.length != 0) {\n    var val = cookies.match('(^|;)[\\s]*' + name + '=([^;]*)');\n    if (val && val[2]) {\n      return decodeURIComponent(val[2]);\n    }\n  }\n  return '';\n}\n\nfunction toggleEditMask(state) {\n  if (state == 'show') {\n    $('.edit-dialog-backdrop').addClass('active');\n    $('.edit-dialog').addClass('active');\n    if ($('.edit-dialog').data('mode') === 'add') {\n      $('.edit-mask-delete-button').hide();\n    }\n  }\n  else {\n    $('.edit-dialog-backdrop').removeClass('active');\n    $('.edit-dialog').removeClass('active').data('mode', '').data('index', '');\n    $('#edit-mask')[0].reset();\n    $('.edit-mask-delete-button').show();\n  }\n}\n\nfunction updateSortIndicators($current, order) {\n  $('.js-sort-indicator').removeClass('fa-sort fa-sort-asc fa-sort-desc').parent().removeClass('active');\n  $current.find('.js-sort-indicator').addClass('fa-sort-' + order).parent().addClass('active');\n}\n","'use strict';\n\nvar THEME_COOKIE_NAME = 'theme';\nvar THEME_CLASS_NAME  = 'theme-compact';\n\nvar resizeTimer;\n\nfunction initTheme(){\n  if(getCookie(THEME_COOKIE_NAME) === THEME_CLASS_NAME) {\n    $('body').addClass(THEME_CLASS_NAME);\n  };\n}\n\nfunction initDescriptionMoreLinks(){\n  // display 'more' link if needed\n  $('.js-note_item__description').each(function(){\n    if ($(this).height() < $(this).find('.note_item__description-wrapper').height()) {\n      $(this).append('<span class=\"note_item__description-more\"><i class=\"fa fa-plus-square-o\" aria-hidden=\"true\"></span>');\n    }\n  });\n}\n\n/* ------------------------------------------------------- */\n/* MAIN */\n\nvar TheNoteList = new NoteList();\nTheNoteList.init();\n\ninitTheme();\ninitDescriptionMoreLinks();\n\n\n\n\n\n","'use strict';\n\n/**\n * event handler\n */\n\n\n/* ------------------------------------------------------------- */\n/* NOTE LIST GENERAL */\n\n// refresh the list\n$('.note_list').on('notelist:refresh', function(e, options){\n  var source = $('#node_item_template').html();\n  var template = Handlebars.compile(source);\n  var displayList = options;\n  $('.note_list').html(template(displayList));\n  initDescriptionMoreLinks();\n})\n\n\n/* ------------------------------------------------------------- */\n/* NOTE LIST HEADER */\n\n// open new item dialog\n$('.js-button-add-item').on('click', function() {\n  $('#edit-menu-title').text('Add note');\n  $('.edit-dialog').data('mode', 'add')\n  toggleEditMask('show');\n});\n\n// menu toggle (show/hide menu on mobile)\n$('.js-menu-toggle').on('click', function() {\n  $('.app-toolbar').toggleClass('app-toolbar--hidden');\n});\n\n// style toggle\n$('.js-style-toggle').on('click', function() {\n  $('body').toggleClass(THEME_CLASS_NAME);\n  var cval = $('body').hasClass(THEME_CLASS_NAME) ? THEME_CLASS_NAME : 'default';\n  setCookie(THEME_COOKIE_NAME, cval, 30);\n});\n\n// sort items\n$('#js-sort-by-duedate').on('click', function() {\n  $(this).toggleClass('desc');\n  var order = $(this).hasClass('desc') ? 'desc' : 'asc';\n  TheNoteList.sortItems('duedate', order);\n  updateSortIndicators($(this), order);\n});\n$('#js-sort-by-createdate').on('click', function() {\n  $(this).toggleClass('desc');\n  var order = $(this).hasClass('desc') ? 'desc' : 'asc';\n  TheNoteList.sortItems('createdate', order);\n  updateSortIndicators($(this), order);\n});\n$('#js-sort-by-priority').on('click', function() {\n  $(this).toggleClass('desc');\n  var order = $(this).hasClass('desc') ? 'desc' : 'asc';\n  TheNoteList.sortItems('priority', order);\n  updateSortIndicators($(this), order);\n});\n\n// filter items\n$('#js-filter-done').on('click', function() {\n  var icon = (TheNoteList.toggleShowFinished()) ? 'eye' : 'eye-slash';\n  $(this).find('.js-filter-done-indicator').removeClass('fa-eye fa-eye-slash').addClass('fa-'+icon);\n});\n\n\n/* ------------------------------------------------------------- */\n/* NOTE ITEMS */\n\n// edit item\n$('.note_list').on('click', '.js-button-edit-item',  function () {\n  var index = $(this).data('id');\n  var item = TheNoteList.getItem(index);\n\n  $('#edit-id').val(item._id);\n  $('#edit-isDone').val(item.isDone);\n  $('#edit-title').val(item.title);\n  $('#edit-description').val(item.description);\n  $('input[name=\"edit-priority\"][value=\"'+item.priority+'\"]').prop('checked', true);\n\n\n  var finishdate_tmp = item.finishdate;\n  var finishdate = (finishdate_tmp != '' && finishdate_tmp != 0) ? finishdate_tmp : 0;\n  item.finishdate = finishdate;\n\n  $('#edit-finishdate').val(getFormattedDate(new Date(item.finishdate)), false);\n\n\n  if(item.duedate !== 0) {\n    $('#edit-duedate').val(getFormattedDate(new Date(item.duedate)), false);\n  }\n\n  $('#edit-menu-title').text('Edit note');\n  toggleEditMask('show');\n  $('.edit-dialog').data('mode', 'edit').data('index', index);\n});\n\n// handle item checkbox\n$('.note_list').on('click', '.js-item-flag-done', function() {\n  var item = TheNoteList.getItem($(this).data('id'));\n  if($(this).prop('checked')) {\n    item.isDone = true;\n    item.finishdate = Date.now();\n  }\n  else {\n    item.isDone = false;\n    item.finishdate = 0;\n  }\n  TheNoteList.replaceItem($(this).data('id'), item);\n});\n\n// handle description overflow\n$('.note_list').on('click', '.js-note_item__description', function() {\n  $(this).toggleClass('note_item__description--expanded');\n\n  var $more = $(this).find('.note_item__description-more .fa');\n  $more.removeClass('fa-plus-square-o fa-minus-square-o');\n  $more.addClass(($(this).hasClass('note_item__description--expanded')) ? 'fa-minus-square-o' : 'fa-plus-square-o');\n});\n\n//re-evaluate description 'more' links\n$(window).on('resize', function() {\n  clearTimeout(resizeTimer);\n  resizeTimer = setTimeout(function() {\n    initDescriptionMoreLinks();\n  }, 200);\n});\n\n\n/* ------------------------------------------------------------- */\n/* EDIT MASK */\n\n// cancel button (cancel edit mask)\n$('.js-button-item-cancel').on('click', function() {\n  toggleEditMask('hide');\n});\n\n// save button (add/update item)\n$('.js-btn-item-save').on('click', function() {\n  var title = $('#edit-title').val();\n  var description = $('#edit-description').val();\n  var priority = 0;\n  var duedate = 0;\n  var finishdate = $('#edit-finishdate').val();\n  var _id = $('#edit-id').val();\n  var isDone = false;\n\n  if($('.edit-dialog').data('mode') == 'edit') {\n    isDone = ($('#edit-isDone').val() == 'true') ? true : false;\n  }\n\n  if ($('input[name=\"edit-priority\"]:checked').val()) {\n    priority = parseInt($('input[name=\"edit-priority\"]:checked').val());\n  }\n  if($('#edit-duedate').val() !== ''){\n    duedate = Date.parse($('#edit-duedate').val())\n  }\n\n\n  var item = new Note(title, description, priority, duedate, isDone, finishdate, _id);\n\n  if($('.edit-dialog').data('mode') == 'edit') {\n    var index = $('.edit-dialog').data('index');\n    TheNoteList.replaceItem(index, item);\n  } else {\n    TheNoteList.addItem(item);\n  }\n  toggleEditMask('hide');\n});\n\n// delete button (delete an item)\n$('.js-button-delete-item').on('click', function() {\n  if(window.confirm('Delete this note?')) {\n    var index = $('.edit-dialog').data('index');\n    var _id = $('#edit-id').val();\n    TheNoteList.deleteItem(index, _id);\n    toggleEditMask('hide');\n  }\n});\n\n// today button (for due date)\n$('.js-btn-duedate-today').on('click', function() {\n  $('#edit-duedate').val(getToday());\n});\n\n// tomorrow button (for due date)\n$('.js-btn-duedate-tomorrow').on('click', function() {\n  $('#edit-duedate').val(getTomorrow());\n});\n\n// reset prio button\n$('.js-btn-reset-prio').on('click', function() {\n  $('.edit-priority').attr('checked', false);\n});\n\n"],"sourceRoot":"/source/"}